---
const { lang, t } = Astro.props;
const switchUrl = lang === "es" ? "/en" : "/";
---
<header>
  <nav class="nav">
  <strong class="logo">Facundo Ruiz</strong>

  <!-- Acciones derecha -->
  <div class="nav-actions">
    <button
      id="theme-toggle"
      aria-label="Toggle theme"
      class="theme-toggle"
    >
      <img
        id="theme-icon"
        src="/icons/moon.svg"
        alt="Toggle theme"
        width="18"
        height="18"
      />
    </button>

    <button
      class="nav-toggle"
      aria-label="Toggle menu"
      aria-expanded="false"
    >
      â˜°
    </button>
  </div>

  <ul class="nav-menu">
    <li><a href="#projects">{t.nav.projects}</a></li>
    <li><a href="#skills">{t.nav.skills}</a></li>

    <li>
      <a href={switchUrl} transition:name="lang">
        {lang === "es" ? "EN" : "ES"}
      </a>
    </li>
  </ul>
</nav>
</header>

<script>
  function initHeader() {
    const toggle = document.querySelector(".nav-toggle");
    const menu = document.querySelector(".nav-menu");

    if (!toggle || !menu) return;

    toggle.onclick = () => {
      const open = menu.classList.toggle("open");
      toggle.setAttribute("aria-expanded", open);
    };
  }

  initHeader();
  document.addEventListener("astro:page-load", initHeader);

  /* theme toggle (no se toca) */
  function initThemeToggle() {
    const btn = document.getElementById("theme-toggle");
    const icon = document.getElementById("theme-icon");
    if (!btn || !icon || !window.toggleTheme) return;

    function syncIcon() {
      const isDark = document.documentElement.dataset.theme === "dark";
      icon.src = isDark ? "/icons/sun.svg" : "/icons/moon.svg";
      icon.alt = isDark ? "Switch to light mode" : "Switch to dark mode";
    }

    syncIcon();
    btn.onclick = () => window.toggleTheme();
    document.addEventListener("theme-change", syncIcon);
  }

  initThemeToggle();
  document.addEventListener("astro:page-load", initThemeToggle);
</script>

